# Bee测试网络初始化流程

节点启动后会生成一个以太坊的地址(以下称为EA1)，这个时候节点并不会正常启动，需要往这个EA1里面送geth和gbzz，系统会提示兑换地址

我的测试网络EA1是0xec376bd645a89c96830992ccd1144476d4772b0e

兑换页面可以获取0.05个geth，如果不够可以到goerli的测试网络水龙头上再申请

当EA1有10个gbzz和geth手续费后节点就能够自动启动了

节点启动后会自动使用EA1调用这个合约
`0xf0277caffea72734853b834afc9892461ea18474`

[参考交易](https://goerli.etherscan.io/tx/0x97bbb2787aa4d2fdec6f0a33872e0a27befede5dd4fc84fe843984baa7f22466)

调用的方法

```
Function: deploySimpleSwap(address issuer, uint256 defaultHardDepositTimeoutDuration) ***

MethodID: 0x576d7271
[0]:  000000000000000000000000ec376bd645a89c96830992ccd1144476d4772b0e
[1]:  0000000000000000000000000000000000000000000000000000000000000000
```

这个方法会创建一个新的支票合约
`0x9DfA662B12993eCfB0d70cdca0fa9111CBE3AB6f`

[参考地址](https://goerli.etherscan.io/address/0x9DfA662B12993eCfB0d70cdca0fa9111CBE3AB6f#code)

然后节点会将EA1的10个gbzz发送给支票合约



兑换合约

https://goerli.etherscan.io/tx/0x6605834ccd0814e65b4b7908ab9a73d7a7689eb06779e878b8578ec648cfe30f


别人的10gBZZ
```
0xbe228dcc
000000000000000000000000000000000000000000000000016345785d8a0000
000000000000000000000000000000000000000000000000559ead6360b6da90
0000000000000000000000000000000000000000000000000000000060544ffc
00000000000000000000000048cc3a666b382d23485502ec31304cca59f794ba
```

别人的10gBZZ
```
0xbe228dcc
000000000000000000000000000000000000000000000000016345785d8a0000
000000000000000000000000000000000000000000000000559ec84ebd9ee670
0000000000000000000000000000000000000000000000000000000060544ffa
000000000000000000000000c239f0c558f7f93e57a7e3101324ff4ded4f4607
```


我的5gBZZ 10
```
0xbe228dcc
00000000000000000000000000000000000000000000000000b1a2bc2ec50000
0000000000000000000000000000000000000000000000002a519e230f9b9320
00000000000000000000000000000000000000000000000000000000605304ce
000000000000000000000000ec376bd645a89c96830992ccd1144476d4772b0e
```

```
0xbe228dcc
00000000000000000000000000000000000000000000000000b1a2bc2ec50000
0000000000000000000000000000000000000000000000002a51977bc4924e6c
00000000000000000000000000000000000000000000000000000000605303ca
000000000000000000000000ec376bd645a89c96830992ccd1144476d4772b0e
```

测试兑换1个BZZ

```
0xbe228dcc
000000000000000000000000000000000000000000000000002386f26fc10000
000000000000000000000000000000000000000000000000088fffec6f5b0bc8
0000000000000000000000000000000000000000000000000000000060545b6d
000000000000000000000000ec376bd645a89c96830992ccd1144476d4772b0e
```

测试兑换10个

平滑0.1%，需要0.035个geth，实际支付0.035374


```
0xbe228dcc
000000000000000000000000000000000000000000000000016345785d8a0000
00000000000000000000000000000000000000000000000050fbd9d26990d708
0000000000000000000000000000000000000000000000000000000060583fc3
000000000000000000000000ec376bd645a89c96830992ccd1144476d4772b0e
```

最终分析确定

- 第一个参数是数量，n*10**16.hex()
- 第二个参数兑换的gDAI的单价*数量
- 第三个参数是timestamp
- 第四个参数是兑换发送的地址

gDAI价格获取

这个合约 `0x49e3cfe28ca3cd0eaf48ad53aa69481f3adc6ec9`

DATA:
 
```
0xc4dbf622000000000000000000000000000000000000000000000000002386f26fc10000
```

script:

```
eth_grpc_api="https://goerli.infura.io/v3/3e88bb0189ea44c0904699e0dfff5641"
curl -XPOST -s -d '{"jsonrpc":"2.0","id":1,"method":"eth_call","params":[{"data":"0xc4dbf622000000000000000000000000000000000000000000000000002386f26fc10000","to":"0x49e3cfe28ca3cd0eaf48ad53aa69481f3adc6ec9"},"latest"]}' ${eth_grpc_api} | jq .result

```